<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Calf.Phase.Open</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Comment">-- Open/extensional modality.</a>

<a id="61" class="Keyword">module</a> <a id="68" href="Calf.Phase.Open.html" class="Module">Calf.Phase.Open</a> <a id="84" class="Keyword">where</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Calf.Prelude.html" class="Module">Calf.Prelude</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Calf.CBPV.html" class="Module">Calf.CBPV</a>
<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="188" class="Symbol">as</a> <a id="191" class="Module">Eq</a> <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="204" class="Symbol">;</a> <a id="206" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="210" class="Symbol">)</a>

<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Calf.Phase.Core.html" class="Module">Calf.Phase.Core</a>


<a id="◯"></a><a id="243" href="Calf.Phase.Open.html#243" class="Function">◯</a> <a id="245" class="Symbol">:</a> <a id="247" href="Calf.Prelude.html#150" class="Function">□</a> <a id="249" class="Symbol">→</a> <a id="251" href="Calf.Prelude.html#150" class="Function">□</a>
<a id="253" href="Calf.Phase.Open.html#243" class="Function">◯</a> <a id="255" href="Calf.Phase.Open.html#255" class="Bound">𝕁</a> <a id="257" class="Symbol">=</a> <a id="259" class="Symbol">(</a><a id="260" href="Calf.Phase.Open.html#260" class="Bound">u</a> <a id="262" class="Symbol">:</a> <a id="264" href="Calf.Phase.Core.html#163" class="Postulate">ext</a><a id="267" class="Symbol">)</a> <a id="269" class="Symbol">→</a> <a id="271" href="Calf.Phase.Open.html#255" class="Bound">𝕁</a>

<a id="274" class="Keyword">postulate</a>
  <a id="open⁺"></a><a id="286" href="Calf.Phase.Open.html#286" class="Postulate">open⁺</a> <a id="292" class="Symbol">:</a> <a id="294" class="Symbol">(</a><a id="295" href="Calf.Phase.Core.html#163" class="Postulate">ext</a> <a id="299" class="Symbol">→</a> <a id="301" href="Calf.CBPV.html#376" class="Postulate">tp⁺</a><a id="304" class="Symbol">)</a> <a id="306" class="Symbol">→</a> <a id="308" href="Calf.CBPV.html#376" class="Postulate">tp⁺</a>
  <a id="open⁺/decode"></a><a id="314" href="Calf.Phase.Open.html#314" class="Postulate">open⁺/decode</a> <a id="327" class="Symbol">:</a> <a id="329" class="Symbol">∀</a> <a id="331" class="Symbol">{</a><a id="332" href="Calf.Phase.Open.html#332" class="Bound">A</a><a id="333" class="Symbol">}</a> <a id="335" class="Symbol">→</a> <a id="337" href="Calf.CBPV.html#396" class="Postulate">val</a> <a id="341" class="Symbol">(</a><a id="342" href="Calf.Phase.Open.html#286" class="Postulate">open⁺</a> <a id="348" href="Calf.Phase.Open.html#332" class="Bound">A</a><a id="349" class="Symbol">)</a> <a id="351" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="353" class="Symbol">((</a><a id="355" href="Calf.Phase.Open.html#355" class="Bound">u</a> <a id="357" class="Symbol">:</a> <a id="359" href="Calf.Phase.Core.html#163" class="Postulate">ext</a><a id="362" class="Symbol">)</a> <a id="364" class="Symbol">→</a> <a id="366" href="Calf.CBPV.html#396" class="Postulate">val</a> <a id="370" class="Symbol">(</a><a id="371" href="Calf.Phase.Open.html#332" class="Bound">A</a> <a id="373" href="Calf.Phase.Open.html#355" class="Bound">u</a><a id="374" class="Symbol">))</a>
  <a id="379" class="Symbol">{-#</a> <a id="383" class="Keyword">REWRITE</a> <a id="391" href="Calf.Phase.Open.html#314" class="Postulate">open⁺/decode</a> <a id="404" class="Symbol">#-}</a>

  <a id="open⁻"></a><a id="411" href="Calf.Phase.Open.html#411" class="Postulate">open⁻</a> <a id="417" class="Symbol">:</a> <a id="419" class="Symbol">(</a><a id="420" href="Calf.Phase.Core.html#163" class="Postulate">ext</a> <a id="424" class="Symbol">→</a> <a id="426" href="Calf.CBPV.html#386" class="Postulate">tp⁻</a><a id="429" class="Symbol">)</a> <a id="431" class="Symbol">→</a> <a id="433" href="Calf.CBPV.html#386" class="Postulate">tp⁻</a>
  <a id="open⁻/decode"></a><a id="439" href="Calf.Phase.Open.html#439" class="Postulate">open⁻/decode</a> <a id="452" class="Symbol">:</a> <a id="454" class="Symbol">∀</a> <a id="456" class="Symbol">{</a><a id="457" href="Calf.Phase.Open.html#457" class="Bound">A</a><a id="458" class="Symbol">}</a> <a id="460" class="Symbol">→</a> <a id="462" href="Calf.CBPV.html#396" class="Postulate">val</a> <a id="466" class="Symbol">(</a><a id="467" href="Calf.CBPV.html#429" class="Postulate">U</a> <a id="469" class="Symbol">(</a><a id="470" href="Calf.Phase.Open.html#411" class="Postulate">open⁻</a> <a id="476" href="Calf.Phase.Open.html#457" class="Bound">A</a><a id="477" class="Symbol">))</a> <a id="480" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="482" class="Symbol">((</a><a id="484" href="Calf.Phase.Open.html#484" class="Bound">u</a> <a id="486" class="Symbol">:</a> <a id="488" href="Calf.Phase.Core.html#163" class="Postulate">ext</a><a id="491" class="Symbol">)</a> <a id="493" class="Symbol">→</a> <a id="495" href="Calf.CBPV.html#595" class="Function">cmp</a> <a id="499" class="Symbol">(</a><a id="500" href="Calf.Phase.Open.html#457" class="Bound">A</a> <a id="502" href="Calf.Phase.Open.html#484" class="Bound">u</a><a id="503" class="Symbol">))</a>
  <a id="508" class="Symbol">{-#</a> <a id="512" class="Keyword">REWRITE</a> <a id="520" href="Calf.Phase.Open.html#439" class="Postulate">open⁻/decode</a> <a id="533" class="Symbol">#-}</a>

<a id="538" class="Keyword">infix</a> <a id="544" class="Number">10</a> <a id="547" href="Calf.Phase.Open.html#555" class="Function Operator">◯⁺_</a> <a id="551" href="Calf.Phase.Open.html#592" class="Function Operator">◯⁻_</a>
<a id="◯⁺_"></a><a id="555" href="Calf.Phase.Open.html#555" class="Function Operator">◯⁺_</a> <a id="559" class="Symbol">:</a> <a id="561" href="Calf.CBPV.html#376" class="Postulate">tp⁺</a> <a id="565" class="Symbol">→</a> <a id="567" href="Calf.CBPV.html#376" class="Postulate">tp⁺</a>
<a id="571" href="Calf.Phase.Open.html#555" class="Function Operator">◯⁺</a> <a id="574" href="Calf.Phase.Open.html#574" class="Bound">A</a> <a id="576" class="Symbol">=</a> <a id="578" href="Calf.Phase.Open.html#286" class="Postulate">open⁺</a> <a id="584" class="Symbol">λ</a> <a id="586" href="Calf.Phase.Open.html#586" class="Bound">_</a> <a id="588" class="Symbol">→</a> <a id="590" href="Calf.Phase.Open.html#574" class="Bound">A</a>
<a id="◯⁻_"></a><a id="592" href="Calf.Phase.Open.html#592" class="Function Operator">◯⁻_</a> <a id="596" class="Symbol">:</a> <a id="598" href="Calf.CBPV.html#386" class="Postulate">tp⁻</a> <a id="602" class="Symbol">→</a> <a id="604" href="Calf.CBPV.html#386" class="Postulate">tp⁻</a>
<a id="608" href="Calf.Phase.Open.html#592" class="Function Operator">◯⁻</a> <a id="611" href="Calf.Phase.Open.html#611" class="Bound">A</a> <a id="613" class="Symbol">=</a> <a id="615" href="Calf.Phase.Open.html#411" class="Postulate">open⁻</a> <a id="621" class="Symbol">λ</a> <a id="623" href="Calf.Phase.Open.html#623" class="Bound">_</a> <a id="625" class="Symbol">→</a> <a id="627" href="Calf.Phase.Open.html#611" class="Bound">A</a>


<a id="631" class="Keyword">module</a> <a id="638" href="Calf.Phase.Open.html#638" class="Module">_</a> <a id="640" class="Keyword">where</a>
  <a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Algebra.Cost.html" class="Module">Algebra.Cost</a>

  <a id="676" href="Calf.Phase.Open.html#676" class="Function">◯-CostMonoid</a> <a id="689" class="Symbol">:</a> <a id="691" href="Algebra.Cost.Bundles.html#322" class="Record">CostMonoid</a> <a id="702" class="Symbol">→</a> <a id="704" href="Algebra.Cost.Bundles.html#322" class="Record">CostMonoid</a>
  <a id="717" href="Calf.Phase.Open.html#676" class="Function">◯-CostMonoid</a> <a id="730" href="Calf.Phase.Open.html#730" class="Bound">cm</a> <a id="733" class="Symbol">=</a>
    <a id="739" class="Keyword">record</a>
      <a id="752" class="Symbol">{</a> <a id="754" href="Algebra.Cost.Bundles.html#374" class="Field">ℂ</a> <a id="756" class="Symbol">=</a> <a id="758" href="Calf.Phase.Open.html#243" class="Function">◯</a> <a id="760" href="Algebra.Cost.Bundles.html#374" class="Field">ℂ</a>
      <a id="768" class="Symbol">;</a> <a id="770" href="Algebra.Cost.Bundles.html#418" class="Field Operator">_+_</a> <a id="774" class="Symbol">=</a> <a id="776" class="Symbol">λ</a> <a id="778" href="Calf.Phase.Open.html#778" class="Bound">c₁</a> <a id="781" href="Calf.Phase.Open.html#781" class="Bound">c₂</a> <a id="784" href="Calf.Phase.Open.html#784" class="Bound">u</a> <a id="786" class="Symbol">→</a> <a id="788" href="Calf.Phase.Open.html#778" class="Bound">c₁</a> <a id="791" href="Calf.Phase.Open.html#784" class="Bound">u</a> <a id="793" href="Algebra.Cost.Bundles.html#418" class="Field Operator">+</a> <a id="795" href="Calf.Phase.Open.html#781" class="Bound">c₂</a> <a id="798" href="Calf.Phase.Open.html#784" class="Bound">u</a>
      <a id="806" class="Symbol">;</a> <a id="808" href="Algebra.Cost.Bundles.html#397" class="Field">zero</a> <a id="813" class="Symbol">=</a> <a id="815" class="Symbol">λ</a> <a id="817" href="Calf.Phase.Open.html#817" class="Bound">u</a> <a id="819" class="Symbol">→</a> <a id="821" href="Algebra.Cost.Bundles.html#397" class="Field">zero</a>
      <a id="832" class="Symbol">;</a> <a id="834" href="Algebra.Cost.Bundles.html#443" class="Field Operator">_≤_</a> <a id="838" class="Symbol">=</a> <a id="840" class="Symbol">λ</a> <a id="842" href="Calf.Phase.Open.html#842" class="Bound">c₁</a> <a id="845" href="Calf.Phase.Open.html#845" class="Bound">c₂</a> <a id="848" class="Symbol">→</a> <a id="850" class="Symbol">(</a><a id="851" href="Calf.Phase.Open.html#851" class="Bound">u</a> <a id="853" class="Symbol">:</a> <a id="855" href="Calf.Phase.Core.html#163" class="Postulate">ext</a><a id="858" class="Symbol">)</a> <a id="860" class="Symbol">→</a> <a id="862" href="Calf.Phase.Open.html#842" class="Bound">c₁</a> <a id="865" href="Calf.Phase.Open.html#851" class="Bound">u</a> <a id="867" href="Algebra.Cost.Bundles.html#443" class="Field Operator">≤</a> <a id="869" href="Calf.Phase.Open.html#845" class="Bound">c₂</a> <a id="872" href="Calf.Phase.Open.html#851" class="Bound">u</a>
      <a id="880" class="Symbol">;</a> <a id="882" href="Algebra.Cost.Bundles.html#471" class="Field">isCostMonoid</a> <a id="895" class="Symbol">=</a>
          <a id="907" class="Keyword">record</a>
            <a id="926" class="Symbol">{</a> <a id="928" href="Algebra.Cost.Structures.html#970" class="Field">isMonoid</a> <a id="937" class="Symbol">=</a>
                <a id="955" class="Keyword">record</a>
                  <a id="980" class="Symbol">{</a> <a id="982" href="Algebra.Structures.html#3936" class="Field">isSemigroup</a> <a id="994" class="Symbol">=</a>
                      <a id="1018" class="Keyword">record</a>
                        <a id="1049" class="Symbol">{</a> <a id="1051" href="Algebra.Structures.html#2854" class="Field">isMagma</a> <a id="1059" class="Symbol">=</a>
                            <a id="1089" class="Keyword">record</a>
                              <a id="1126" class="Symbol">{</a> <a id="1128" href="Algebra.Structures.html#1178" class="Field">isEquivalence</a> <a id="1142" class="Symbol">=</a> <a id="1144" href="Relation.Binary.PropositionalEquality.Properties.html#5121" class="Function">Eq.isEquivalence</a>
                              <a id="1191" class="Symbol">;</a> <a id="1193" href="Algebra.Structures.html#1216" class="Field">∙-cong</a> <a id="1200" class="Symbol">=</a> <a id="1202" href="Relation.Binary.PropositionalEquality.Core.html#1390" class="Function">Eq.cong₂</a> <a id="1211" class="Symbol">_</a>
                              <a id="1243" class="Symbol">}</a>
                        <a id="1269" class="Symbol">;</a> <a id="1271" href="Algebra.Structures.html#2878" class="Field">assoc</a> <a id="1277" class="Symbol">=</a> <a id="1279" class="Symbol">λ</a> <a id="1281" href="Calf.Phase.Open.html#1281" class="Bound">c₁</a> <a id="1284" href="Calf.Phase.Open.html#1284" class="Bound">c₂</a> <a id="1287" href="Calf.Phase.Open.html#1287" class="Bound">c₃</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Calf.Prelude.html#268" class="Postulate">funext/Ω</a> <a id="1301" class="Symbol">λ</a> <a id="1303" href="Calf.Phase.Open.html#1303" class="Bound">u</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="Algebra.Cost.Structures.html#1232" class="Function">+-assoc</a> <a id="1315" class="Symbol">(</a><a id="1316" href="Calf.Phase.Open.html#1281" class="Bound">c₁</a> <a id="1319" href="Calf.Phase.Open.html#1303" class="Bound">u</a><a id="1320" class="Symbol">)</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Calf.Phase.Open.html#1284" class="Bound">c₂</a> <a id="1326" href="Calf.Phase.Open.html#1303" class="Bound">u</a><a id="1327" class="Symbol">)</a> <a id="1329" class="Symbol">(</a><a id="1330" href="Calf.Phase.Open.html#1287" class="Bound">c₃</a> <a id="1333" href="Calf.Phase.Open.html#1303" class="Bound">u</a><a id="1334" class="Symbol">)</a>
                        <a id="1360" class="Symbol">}</a>
                  <a id="1380" class="Symbol">;</a> <a id="1382" href="Algebra.Structures.html#3968" class="Field">identity</a> <a id="1391" class="Symbol">=</a>
                      <a id="1415" class="Symbol">(λ</a> <a id="1418" href="Calf.Phase.Open.html#1418" class="Bound">c</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Calf.Prelude.html#268" class="Postulate">funext/Ω</a> <a id="1431" class="Symbol">λ</a> <a id="1433" href="Calf.Phase.Open.html#1433" class="Bound">u</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Algebra.Cost.Structures.html#1172" class="Function">+-identityˡ</a> <a id="1449" class="Symbol">(</a><a id="1450" href="Calf.Phase.Open.html#1418" class="Bound">c</a> <a id="1452" href="Calf.Phase.Open.html#1433" class="Bound">u</a><a id="1453" class="Symbol">))</a> <a id="1456" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a>
                      <a id="1480" class="Symbol">(λ</a> <a id="1483" href="Calf.Phase.Open.html#1483" class="Bound">c</a> <a id="1485" class="Symbol">→</a> <a id="1487" href="Calf.Prelude.html#268" class="Postulate">funext/Ω</a> <a id="1496" class="Symbol">λ</a> <a id="1498" href="Calf.Phase.Open.html#1498" class="Bound">u</a> <a id="1500" class="Symbol">→</a> <a id="1502" href="Algebra.Cost.Structures.html#1204" class="Function">+-identityʳ</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Calf.Phase.Open.html#1483" class="Bound">c</a> <a id="1517" href="Calf.Phase.Open.html#1498" class="Bound">u</a><a id="1518" class="Symbol">))</a>
                  <a id="1539" class="Symbol">}</a>
            <a id="1553" class="Symbol">;</a> <a id="1555" href="Algebra.Cost.Structures.html#1009" class="Field">isPreorder</a> <a id="1566" class="Symbol">=</a>
                <a id="1584" class="Keyword">record</a>
                  <a id="1609" class="Symbol">{</a> <a id="1611" href="Relation.Binary.Structures.html#2251" class="Field">isEquivalence</a> <a id="1625" class="Symbol">=</a> <a id="1627" href="Relation.Binary.PropositionalEquality.Properties.html#5121" class="Function">Eq.isEquivalence</a>
                  <a id="1662" class="Symbol">;</a> <a id="1664" href="Relation.Binary.Structures.html#2354" class="Field">reflexive</a> <a id="1674" class="Symbol">=</a> <a id="1676" class="Symbol">λ</a> <a id="1678" href="Calf.Phase.Open.html#1678" class="Bound">h</a> <a id="1680" href="Calf.Phase.Open.html#1680" class="Bound">u</a> <a id="1682" class="Symbol">→</a> <a id="1684" href="Algebra.Cost.Structures.html#1323" class="Function">≤-reflexive</a> <a id="1696" class="Symbol">(</a><a id="1697" href="Relation.Binary.PropositionalEquality.Core.html#1153" class="Function">Eq.cong</a> <a id="1705" class="Symbol">(λ</a> <a id="1708" href="Calf.Phase.Open.html#1708" class="Bound">x</a> <a id="1710" class="Symbol">→</a> <a id="1712" href="Calf.Phase.Open.html#1708" class="Bound">x</a> <a id="1714" href="Calf.Phase.Open.html#1680" class="Bound">u</a><a id="1715" class="Symbol">)</a> <a id="1717" href="Calf.Phase.Open.html#1678" class="Bound">h</a><a id="1718" class="Symbol">)</a>
                  <a id="1738" class="Symbol">;</a> <a id="1740" href="Relation.Binary.Structures.html#2384" class="Field">trans</a> <a id="1746" class="Symbol">=</a> <a id="1748" class="Symbol">λ</a> <a id="1750" href="Calf.Phase.Open.html#1750" class="Bound">h₁</a> <a id="1753" href="Calf.Phase.Open.html#1753" class="Bound">h₂</a> <a id="1756" href="Calf.Phase.Open.html#1756" class="Bound">u</a> <a id="1758" class="Symbol">→</a> <a id="1760" href="Algebra.Cost.Structures.html#1361" class="Function">≤-trans</a> <a id="1768" class="Symbol">(</a><a id="1769" href="Calf.Phase.Open.html#1750" class="Bound">h₁</a> <a id="1772" href="Calf.Phase.Open.html#1756" class="Bound">u</a><a id="1773" class="Symbol">)</a> <a id="1775" class="Symbol">(</a><a id="1776" href="Calf.Phase.Open.html#1753" class="Bound">h₂</a> <a id="1779" href="Calf.Phase.Open.html#1756" class="Bound">u</a><a id="1780" class="Symbol">)</a>
                  <a id="1800" class="Symbol">}</a>
            <a id="1814" class="Symbol">;</a> <a id="1816" href="Algebra.Cost.Structures.html#1045" class="Field">isMonotone</a> <a id="1827" class="Symbol">=</a>
                <a id="1845" class="Keyword">record</a>
                  <a id="1870" class="Symbol">{</a> <a id="1872" href="Algebra.Cost.Structures.html#535" class="Field">∙-mono-≤</a> <a id="1881" class="Symbol">=</a> <a id="1883" class="Symbol">λ</a> <a id="1885" href="Calf.Phase.Open.html#1885" class="Bound">h₁</a> <a id="1888" href="Calf.Phase.Open.html#1888" class="Bound">h₂</a> <a id="1891" href="Calf.Phase.Open.html#1891" class="Bound">u</a> <a id="1893" class="Symbol">→</a> <a id="1895" href="Algebra.Cost.Structures.html#1440" class="Function">+-mono-≤</a> <a id="1904" class="Symbol">(</a><a id="1905" href="Calf.Phase.Open.html#1885" class="Bound">h₁</a> <a id="1908" href="Calf.Phase.Open.html#1891" class="Bound">u</a><a id="1909" class="Symbol">)</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Calf.Phase.Open.html#1888" class="Bound">h₂</a> <a id="1915" href="Calf.Phase.Open.html#1891" class="Bound">u</a><a id="1916" class="Symbol">)</a>
                  <a id="1936" class="Symbol">}</a>
            <a id="1950" class="Symbol">}</a>
      <a id="1958" class="Symbol">}</a>
      <a id="1966" class="Keyword">where</a>
        <a id="1980" class="Keyword">open</a> <a id="1985" href="Algebra.Cost.Bundles.html#322" class="Module">CostMonoid</a> <a id="1996" href="Calf.Phase.Open.html#730" class="Bound">cm</a>
        <a id="2007" class="Keyword">open</a> <a id="2012" class="Keyword">import</a> <a id="2019" href="Data.Product.html" class="Module">Data.Product</a>
</pre></body></html>